"use strict";(self.webpackChunkcontainer=self.webpackChunkcontainer||[]).push([[2116],{4276:(e,n,r)=>{r.d(n,{A:()=>l});var t=r(3512),i=r(4650),o=function(e){var n=e.app.deal;return(null==n?void 0:n.amount)||(null==n?void 0:n.contacts)||(null==n?void 0:n.id)?n:null},l=function(){var e=(0,t.useDispatch)();return{deal:(0,t.useSelector)(o),hydrateDeal:function(n){return e((0,i.Es)(n))},clearDeal:function(){return e((0,i.K6)())}}}},5076:(e,n,r)=>{r.d(n,{D:()=>l});var t=r(4848),i=r(1527),o=r(4276),l=function(e){var n=e.children,r=e.deal,l=(0,o.A)(),a=l.hydrateDeal,c=l.clearDeal;return(0,i.useEffect)(function(){r&&a(r)},[r]),(0,i.useEffect)(function(){return function(){c()}},[]),(0,t.jsx)(t.Fragment,{children:n})}},8577:(e,n,r)=>{r.d(n,{A:()=>R});var t=r(4848),i=r(4516),o=r(4408),l=r(1527),a=r(9422),c=r(2339),u=r(6816),s=r(4276),d=r(1226),p=r(7883),f=r(7852),h=r(416),v=r(2742),m=r(9678),x=r(4262),y=r(3263),b=function(){var e=(0,y.A)(),n=e.data,r=e.isLoading,t=e.isError,i=e.error,o=e.refetch,a=(0,s.A)().deal,c=function(){var e=["UAH","USD","EUR"],n=x.l.XTS;return m.Cu||m.zD?function(e,n,r){if(r||2===arguments.length)for(var t,i=0,o=n.length;i<o;i++)!t&&i in n||(t||(t=Array.prototype.slice.call(n,0,i)),t[i]=n[i]);return e.concat(t||Array.prototype.slice.call(n))}([n],e,!0):e}(),u=(0,l.useMemo)(function(){var e,n;return null!==(n=null===(e=null==a?void 0:a.contacts)||void 0===e?void 0:e.map(function(e){return Array.isArray(null==e?void 0:e.email)?e.email.map(function(n){var r,t,i;return{id:null!==(r=null==n?void 0:n.value)&&void 0!==r?r:"",label:null!==(t=null==n?void 0:n.value)&&void 0!==t?t:"",owner:null!==(i=null==e?void 0:e.title)&&void 0!==i?i:""}}):[]}).flat().filter(function(e){return!!(null==e?void 0:e.label)}))&&void 0!==n?n:[]},[a]),d=(0,l.useMemo)(function(){var e,n;return null!==(n=null===(e=null==a?void 0:a.contacts)||void 0===e?void 0:e.map(function(e){return Array.isArray(e.phone)?e.phone.map(function(n){var r,t,i;return{id:null!==(r=null==n?void 0:n.value)&&void 0!==r?r:"",label:null!==(t=null==n?void 0:n.value)&&void 0!==t?t:"",owner:null!==(i=null==e?void 0:e.title)&&void 0!==i?i:""}}):[]}).flat().filter(function(e){return!!e.label}))&&void 0!==n?n:[]},[a]);return{accounts:n,currencies:c,recieptDeliveryTransports:["None","Email","SMS","Viber"],emails:u,phones:d,isLoading:r,isError:t,error:i,refetchAccounts:o}},g=r(8247),j=r(9596),w=function(){var e=(0,c.useTranslation)("payment").t;return(0,t.jsx)(o.Stack,{sx:{height:"400px",alignItems:"center",justifyContent:"center",gap:2,px:1},children:(0,t.jsx)(o.Typography,{variant:"h3",children:e("payment:deal.notFound")})})},k=r(8217),S=function(){var e=(0,c.useTranslation)("payment").t;return(0,t.jsxs)(o.Stack,{sx:{height:"400px",alignItems:"center",justifyContent:"center",gap:2,px:1},children:[(0,t.jsx)(o.Typography,{variant:"h1",children:e("payment:views.empty.title")}),(0,t.jsx)(o.Typography,{variant:"body1",sx:{maxWidth:"65ch",textAlign:"center"},children:e("payment:views.empty.reason")})]})},C=function(){return(0,t.jsxs)(o.Stack,{height:"100%",sx:{pt:1},children:[(0,t.jsx)(o.Grid,{container:!0,spacing:1,children:[12,8,4,6,6,8,4].map(function(e,n){return(0,t.jsx)(o.Grid,{item:!0,xs:e,children:(0,t.jsxs)(o.Stack,{spacing:.5,children:[(0,t.jsx)(o.Skeleton,{variant:"text",animation:"wave",sx:{height:16,width:"30%"}}),(0,t.jsx)(o.Skeleton,{variant:"rounded",animation:"wave",sx:{height:56,width:"100%",borderRadius:1}})]})},n)})}),(0,t.jsx)(o.Stack,{pt:3,width:"100%",children:(0,t.jsx)(o.Skeleton,{variant:"rounded",animation:"wave",sx:{height:40,width:"100%",borderRadius:1}})})]})},A=function(e){var n=e.onClick,r=(0,c.useTranslation)("payment").t;return(0,t.jsxs)(o.Stack,{sx:{height:"400px",gap:3,pt:2,alignItems:"center",justifyContent:"center"},children:[(0,t.jsx)(o.Typography,{component:"h2",fontSize:"2rem",textAlign:"center",fontWeight:"600",color:"success.main",children:r("payment:views.success.title")}),(0,t.jsxs)("div",{children:[(0,t.jsx)(o.Typography,{component:"p",sx:{maxWidth:"65ch",textAlign:"center",mx:"auto"},children:r("payment:views.success.reason")}),(0,t.jsx)(o.Typography,{component:"p",sx:{maxWidth:"65ch",textAlign:"center",mx:"auto"},children:r("payment:views.success.description")})]}),(0,t.jsx)(j.W,{onClick:function(e){e.stopPropagation(),n()},variant:"contained",children:r("payment:views.success.back")})]})},T=function(){return T=Object.assign||function(e){for(var n,r=1,t=arguments.length;r<t;r++)for(var i in n=arguments[r])Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i]);return e},T.apply(this,arguments)},D=function(e,n,r){var i=r.selected;return(0,t.jsx)(o.Box,T({component:"li"},e,{sx:{textAlign:"left",display:"flex",flexDirection:"column",alignItems:"flex-start",width:"100%",p:1,backgroundColor:i?"background.tags":""},children:(0,t.jsxs)(o.Box,{width:"100%",children:[(0,t.jsx)(o.Box,{component:"div",sx:{font:"medium"},children:n.label}),(0,t.jsx)(o.Box,{component:"div",color:"text.secondary",sx:{fontSize:"12px"},children:n.owner})]})}))},O=D,E=D,G=r(6084),I=function(){return I=Object.assign||function(e){for(var n,r=1,t=arguments.length;r<t;r++)for(var i in n=arguments[r])Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i]);return e},I.apply(this,arguments)},F=function(e){var n=e.getError,r=e.getTranslationKey,i=e.isDisabled,u=(0,a.useFormContext)(),s=u.control,d=u.watch,p=(0,c.useTranslation)(["payment","validation"]).t,f=d("currency"),h=(0,G.k)(f),v=(0,l.useMemo)(function(){return function(e){var n;if(!["Backspace","ArrowLeft","ArrowRight","Delete","Tab"].includes(e.key)){var r=e.target,t=r.value,i=e.key,o=/^\d$/.test(i),l="."===i||","===i,a=t.includes(".")?".":t.includes(",")?",":null;if(o){if(a){var c=t.indexOf(a);if((null!==(n=r.selectionStart)&&void 0!==n?n:0)>c&&(t.split(a)[1]||"").length>=2)return void e.preventDefault()}}else l&&!a||e.preventDefault()}}},[]);return(0,t.jsx)(a.Controller,{name:"amount",control:s,render:function(e){var l=e.field,a=n(l.name);return(0,t.jsxs)(o.FormControl,{fullWidth:!0,error:!!a,disabled:h||i,children:[(0,t.jsx)(k.iy,{children:p(r("labels.amount"))}),(0,t.jsx)(k.ks,I({},l,{onKeyDown:v,error:!!a,helperText:p(a),value:h?G.w.toFixed(2):l.value,placeholder:p(r("placeholders.amount")),disabled:h||i})),h&&(0,t.jsx)(o.FormHelperText,{children:p(r("helperText.testPayment"))})]})}})},W=r(1366),P=function(e){return"validation:common.".concat(e)},L=W.pipe(W.object({id:W.union([W.number(),W.string()]),label:W.string()}),W.check(function(e){return null!==e},P("predefined"))),N=W.union([W.pipe(W.string(P("invalidString")),W.trim(),W.nonEmpty(P("required")),W.email(P("invalidEmail"))),W.object({id:W.string(P("invalidString")),label:W.string(P("invalidString")),owner:W.string()})],P("required")),q=W.union([W.pipe(W.string(P("invalidString")),W.trim(),W.nonEmpty(P("required"))),W.object({id:W.string(P("invalidString")),label:W.string(P("invalidString")),owner:W.string()})],P("required")),M=W.object({description:W.pipe(W.string(P("invalidString")),W.trim(),W.nonEmpty(P("required"))),amount:W.pipe(W.string(P("invalidString")),W.trim(),W.nonEmpty(P("required")),W.check(function(e){return!isNaN(Number(e))},function(){return P("invalidNumber")})),currency:W.enum(x.l),email:N,phone:q,paymentAccount:L,receiptDelivery:W.enum(x.I)}),z=function(){return z=Object.assign||function(e){for(var n,r=1,t=arguments.length;r<t;r++)for(var i in n=arguments[r])Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i]);return e},z.apply(this,arguments)},B=function(e){var n=e.initial,r=e.onSubmit,u=e.disabled,s=e.loading,d=void 0!==s&&s,p=(0,a.useForm)({defaultValues:n,resolver:(0,i.c)(M)}),f=b(),h=f.accounts,v=f.currencies,m=f.recieptDeliveryTransports,x=f.emails,y=f.phones,g=(0,c.useTranslation)(["payment","validation"]).t;(0,l.useEffect)(function(){h.length&&p.setValue("paymentAccount",h[0])},[h]);var w=p.formState.isSubmitting||u;return(0,t.jsx)(a.FormProvider,z({},p,{children:(0,t.jsxs)(o.Box,{component:"form",sx:{pt:4,px:1},onSubmit:p.handleSubmit(function(e){r(e)}),children:[(0,t.jsxs)(o.Grid,{container:!0,spacing:4,children:[(0,t.jsx)(o.Grid,{item:!0,xs:12,children:(0,t.jsx)(a.Controller,{name:"description",control:p.control,render:function(e){var n=e.field,r=S(n.name);return(0,t.jsxs)(o.FormControl,{fullWidth:!0,error:!!r,disabled:w,children:[(0,t.jsx)(k.iy,{children:g(C("labels.description"))}),(0,t.jsx)(k.ks,z({},n,{error:!!r,helperText:g(r),placeholder:g(C("placeholders.description")),disabled:w}))]})}})}),(0,t.jsx)(o.Grid,{item:!0,xs:8,children:(0,t.jsx)(F,{isDisabled:w,getError:S,getTranslationKey:C})}),(0,t.jsx)(o.Grid,{item:!0,xs:4,children:(0,t.jsx)(a.Controller,{name:"currency",control:p.control,render:function(e){var n=e.field,r=S(n.name);return(0,t.jsxs)(o.FormControl,{fullWidth:!0,error:!!r,disabled:w,children:[(0,t.jsx)(k.iy,{children:g(C("labels.currency"))}),(0,t.jsx)(k.ks,z({},n,{select:!0,error:!!r,helperText:g(r),id:"currency",placeholder:g(C("placeholders.currency")),disabled:w,children:null==v?void 0:v.map(function(e){return(0,t.jsx)(o.MenuItem,{value:e,children:(n=e,(0,G.k)(n)?"".concat(n," (for test account)"):n)},e);var n})}))]})}})}),(0,t.jsx)(o.Grid,{item:!0,xs:6,children:(0,t.jsx)(a.Controller,{name:"email",control:p.control,render:function(e){var n=e.field,r=S(n.name);return(0,t.jsxs)(o.FormControl,{fullWidth:!0,error:!!r,disabled:w,children:[(0,t.jsx)(k.iy,{children:g(C("labels.email"))}),(0,t.jsx)(k.G3,z({},n,{freeSolo:!0,options:x,disabled:w,onInputChange:function(e,r){n.onChange(r)},onChange:function(e,r){n.onChange(r)},renderOption:O,renderInput:function(e){return(0,t.jsx)(k.ks,z({},e,{error:!!r,helperText:g(r),placeholder:g(C("placeholders.email")),disabled:w}))}}))]})}})}),(0,t.jsx)(o.Grid,{item:!0,xs:6,children:(0,t.jsx)(a.Controller,{name:"phone",control:p.control,render:function(e){var n=e.field,r=S(n.name);return(0,t.jsxs)(o.FormControl,{fullWidth:!0,error:!!r,disabled:w,children:[(0,t.jsx)(k.iy,{children:g(C("labels.phone"))}),(0,t.jsx)(k.G3,z({},n,{freeSolo:!0,options:y,disabled:w,onInputChange:function(e,r){n.onChange(r)},onChange:function(e,r){n.onChange(r)},renderOption:E,renderInput:function(e){return(0,t.jsx)(k.ks,z({},e,{error:!!r,helperText:g(r),placeholder:g(C("placeholders.phone")),disabled:w}))}}))]})}})}),(0,t.jsx)(o.Grid,{item:!0,xs:8,children:(0,t.jsx)(a.Controller,{name:"paymentAccount",control:p.control,render:function(e){var n=e.field,r=n.value,i=n.onChange,l=function(e,n){var r={};for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&n.indexOf(t)<0&&(r[t]=e[t]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(t=Object.getOwnPropertySymbols(e);i<t.length;i++)n.indexOf(t[i])<0&&Object.prototype.propertyIsEnumerable.call(e,t[i])&&(r[t[i]]=e[t[i]])}return r}(n,["value","onChange"]),a=S(l.name);return(0,t.jsxs)(o.FormControl,{fullWidth:!0,error:!!a,disabled:w,children:[(0,t.jsx)(k.iy,{children:g(C("labels.paymentAccount"))}),(0,t.jsx)(k.ks,z({},l,{select:!0,value:(null==r?void 0:r.id)||"",onChange:function(e){var n=e.target.value,r=null==h?void 0:h.find(function(e){return e.id===n});i(r||null)},error:!!a,helperText:g(a),id:"currency",placeholder:g(C("placeholders.paymentAccount")),disabled:w,children:null==h?void 0:h.map(function(e){return(0,t.jsx)(o.MenuItem,{value:e.id,children:e.label},e.id)})}))]})}})}),(0,t.jsx)(o.Grid,{item:!0,xs:4,children:(0,t.jsx)(a.Controller,{name:"receiptDelivery",control:p.control,render:function(e){var n=e.field,r=S(n.name);return(0,t.jsxs)(o.FormControl,{fullWidth:!0,error:!!r,disabled:w,children:[(0,t.jsx)(k.iy,{children:g(C("labels.receiptDelivery"))}),(0,t.jsx)(k.ks,z({},n,{select:!0,error:!!r,helperText:g(r),placeholder:g(C("placeholders.receiptDelivery")),disabled:w,children:null==m?void 0:m.map(function(e){return(0,t.jsx)(o.MenuItem,{value:e,children:g(C("predefined.receiptDelivery.".concat(e.toLowerCase())))},e)})}))]})}})})]}),(0,t.jsx)(o.Stack,{pt:3,flexDirection:"row",justifyContent:"center",children:(0,t.jsx)(j.y,{fullWidth:!0,loading:d,type:"submit",variant:"contained",disabled:w,children:g(C("submit"))})})]})}));function S(e){var n,r,t=null!==(r=null===(n=p.formState.errors[e])||void 0===n?void 0:n.message)&&void 0!==r?r:"";return t?g(t):""}function C(e){return"payment:paymentForm.".concat(e)}};const R=function(){var e=(0,l.useState)("idle"),n=e[0],r=e[1],i=(0,l.useRef)(null),a=(0,s.A)().deal,c=function(){var e=(0,p.jL)(),n=(0,p.GV)(v.qu),r=(0,p.GV)(v.x4),t=(0,p.GV)(v.GU);return{generateLink:function(n){return r=void 0,t=void 0,o=function(){return function(e,n){var r,t,i,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},l=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return l.next=a(0),l.throw=a(1),l.return=a(2),"function"==typeof Symbol&&(l[Symbol.iterator]=function(){return this}),l;function a(a){return function(c){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;l&&(l=0,a[0]&&(o=0)),o;)try{if(r=1,t&&(i=2&a[0]?t.return:a[0]?t.throw||((i=t.return)&&i.call(t),0):t.next)&&!(i=i.call(t,a[1])).done)return i;switch(t=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,t=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=n.call(e,o)}catch(e){a=[6,e],t=0}finally{r=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}}(this,function(r){return[2,e((0,h.Cc)(n))]})},new((i=void 0)||(i=Promise))(function(e,n){function l(e){try{c(o.next(e))}catch(e){n(e)}}function a(e){try{c(o.throw(e))}catch(e){n(e)}}function c(n){var r;n.done?e(n.value):(r=n.value,r instanceof i?r:new i(function(e){e(r)})).then(l,a)}c((o=o.apply(r,t||[])).next())});var r,t,i,o},isLoading:r,error:t,isError:!!t,isSuccess:n,reset:(0,l.useCallback)(function(){e(f.E.resetGeneratingRequest())},[])}}(),y=c.generateLink,j=c.isLoading,k=c.error,T=c.isSuccess,D=c.reset,O=b(),E=O.accounts,G=O.currencies,I=O.isLoading,F=(0,d.h)(),W=F.errorNotification,P=F.successNotification,L=(0,l.useMemo)(function(){return function(e,n){var r,t,i,o,l,a,c;if(!Array.isArray(null==e?void 0:e.contacts))return{amount:"",currency:m.Cu||m.zD?x.l.XTS:x.l.UAH,description:"",email:"",paymentAccount:{id:"",label:""},phone:"",receiptDelivery:x.I.None};var u=((null==e?void 0:e.contacts)||[])[0],s=Array.isArray(u.email)?null===(r=u.email[0])||void 0===r?void 0:r.value:"",d=Array.isArray(null==u?void 0:u.phone)?null===(t=u.phone[0])||void 0===t?void 0:t.value:"",p=Array.isArray(null==u?void 0:u.email)?null===(o=null===(i=null==u?void 0:u.email)||void 0===i?void 0:i.find(function(e){return!!(null==e?void 0:e.main)}))||void 0===o?void 0:o.value:s,f=Array.isArray(null==u?void 0:u.phone)?null===(a=null===(l=null==u?void 0:u.phone)||void 0===l?void 0:l.find(function(e){return!!(null==e?void 0:e.main)}))||void 0===a?void 0:a.value:d,h=m.Cu||m.zD?x.l.XTS:n.find(function(n){var r;return n===(null===(r=null==e?void 0:e.amount)||void 0===r?void 0:r.currency)})||x.l.UAH;return{amount:(null===(c=null==e?void 0:e.amount)||void 0===c?void 0:c.value)||"0.00",email:p,phone:f,currency:h,description:"",paymentAccount:null,receiptDelivery:x.I.None}}(a,G)},[a,G]),N="idle"===n,q="success"===n,M=(0,l.useCallback)(function(){return r("idle")},[]),z=(0,l.useCallback)(function(e){return n=void 0,r=void 0,i=function(){var n;return function(e,n){var r,t,i,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},l=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return l.next=a(0),l.throw=a(1),l.return=a(2),"function"==typeof Symbol&&(l[Symbol.iterator]=function(){return this}),l;function a(a){return function(c){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;l&&(l=0,a[0]&&(o=0)),o;)try{if(r=1,t&&(i=2&a[0]?t.return:a[0]?t.throw||((i=t.return)&&i.call(t),0):t.next)&&!(i=i.call(t,a[1])).done)return i;switch(t=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,t=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=n.call(e,o)}catch(e){a=[6,e],t=0}finally{r=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}}(this,function(r){switch(r.label){case 0:return n=(0,g.j)(e,a.id),[4,y(n)];case 1:return r.sent(),[2]}})},new((t=void 0)||(t=Promise))(function(e,o){function l(e){try{c(i.next(e))}catch(e){o(e)}}function a(e){try{c(i.throw(e))}catch(e){o(e)}}function c(n){var r;n.done?e(n.value):(r=n.value,r instanceof t?r:new t(function(e){e(r)})).then(l,a)}c((i=i.apply(n,r||[])).next())});var n,r,t,i},[a]);if((0,l.useEffect)(function(){k&&(W((0,u.u)(k).message),i.current=setTimeout(function(){D(),i.current=null},3e3))},[k]),(0,l.useEffect)(function(){T&&(P(),r("success"))},[T]),(0,l.useEffect)(function(){return function(){null!==i.current&&(clearTimeout(i.current),i.current=null)}},[]),!a)return(0,t.jsx)(w,{});if(I)return(0,t.jsx)(C,{});if(!(null==E?void 0:E.length)&&!I)return(0,t.jsx)(S,{});var R=!I&&!!(null==E?void 0:E.length);return(0,t.jsx)(l.Suspense,{fallback:(0,t.jsx)(C,{}),children:(0,t.jsx)(t.Fragment,{children:R&&(0,t.jsxs)(t.Fragment,{children:[N&&(0,t.jsxs)(o.Stack,{gap:2,children:[(0,t.jsx)(B,{onSubmit:z,initial:L,disabled:j,loading:j}),!!k&&(0,t.jsx)(o.FormHelperText,{error:!0,sx:{fontSize:"1rem"},children:(0,u.u)(k).message})]}),q&&(0,t.jsx)(A,{onClick:M})]})})})}}}]);
//# sourceMappingURL=2116.0345ce95.chunk.js.map