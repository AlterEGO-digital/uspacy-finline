"use strict";(self.webpackChunkcontainer=self.webpackChunkcontainer||[]).push([[6762],{5076:(e,n,r)=>{r.d(n,{D:()=>a});var t=r(4848),i=r(1527),o=r(3512),l=r(5539),a=function(e){var n=e.children,r=e.deal,a=(0,o.useDispatch)();return(0,i.useEffect)(function(){r&&a(l.tR.hydrateDeal({deal:r}))},[r]),(0,i.useEffect)(function(){return function(){a(l.tR.clearDeal())}},[]),(0,t.jsx)(t.Fragment,{children:n})}},8759:(e,n,r)=>{r.d(n,{A:()=>R});var t=r(4848),i=r(4516),o=r(4408),l=r(1527),a=r(9422),c=r(2339),s=r(6816),u=r(3512),d=r(5539),p=function(){return{deal:(0,u.useSelector)(d.LO)}},f=r(1226),h=r(3907),v=[{id:"1",label:"Fop"},{id:"2",label:"TOB"}],x=function(){var e,n,r,t=(0,h.Aq)(),i=(0,h.Db)(),o=(0,h.AX)(),a=p().deal,c=t.isLoading||t.isFetching||i.isLoading||i.isFetching||o.isLoading||o.isFetching,s=t.isError||t.isError||i.isError||i.isError||o.isError||o.isError,u=t.error||t.error||i.error||i.error||o.error||o.error,d=(0,l.useMemo)(function(){var e,n;return null!==(n=null===(e=null==a?void 0:a.contacts)||void 0===e?void 0:e.map(function(e){return e.email.map(function(n){return{id:n.value,label:n.value,owner:e.title}})}).flat().filter(function(e){return!!e.label}))&&void 0!==n?n:[]},[a]),f=(0,l.useMemo)(function(){var e,n;return null!==(n=null===(e=null==a?void 0:a.contacts)||void 0===e?void 0:e.map(function(e){return{id:e.phone,label:e.phone,owner:e.title}}).filter(function(e){return!!e.label}))&&void 0!==n?n:[]},[a]);return{accounts:null!==(e=t.data)&&void 0!==e?e:v,currencies:null!==(n=i.data)&&void 0!==n?n:[],recieptDeliveryTransports:null!==(r=o.data)&&void 0!==r?r:[],emails:d,phones:f,isLoading:c,isError:s,error:u}},m=r(8247),y=r(9596),b=function(){var e=(0,c.useTranslation)("payment").t;return(0,t.jsx)(o.Stack,{sx:{height:"400px",alignItems:"center",justifyContent:"center",gap:2,px:1},children:(0,t.jsx)(o.Typography,{variant:"h3",children:e("payment:deal.notFound")})})},g=r(8217),j=function(){var e=(0,c.useTranslation)("payment").t;return(0,t.jsxs)(o.Stack,{sx:{height:"400px",alignItems:"center",justifyContent:"center",gap:2,px:1},children:[(0,t.jsx)(o.Typography,{variant:"h1",children:e("payment:views.empty.title")}),(0,t.jsx)(o.Typography,{variant:"body1",sx:{maxWidth:"65ch",textAlign:"center"},children:e("payment:views.empty.reason")})]})},w=function(){return(0,t.jsxs)(o.Stack,{height:"100%",sx:{pt:1},children:[(0,t.jsx)(o.Grid,{container:!0,spacing:1,children:[12,8,4,6,6,8,4].map(function(e,n){return(0,t.jsx)(o.Grid,{item:!0,xs:e,children:(0,t.jsxs)(o.Stack,{spacing:.5,children:[(0,t.jsx)(o.Skeleton,{variant:"text",animation:"wave",sx:{height:16,width:"30%"}}),(0,t.jsx)(o.Skeleton,{variant:"rounded",animation:"wave",sx:{height:56,width:"100%",borderRadius:1}})]})},n)})}),(0,t.jsx)(o.Stack,{pt:3,width:"100%",children:(0,t.jsx)(o.Skeleton,{variant:"rounded",animation:"wave",sx:{height:40,width:"100%",borderRadius:1}})})]})},k=function(e){var n=e.onClick,r=(0,c.useTranslation)("payment").t;return(0,t.jsxs)(o.Stack,{sx:{height:"400px",gap:3,pt:2,alignItems:"center",justifyContent:"center"},children:[(0,t.jsx)(o.Typography,{component:"h2",fontSize:"2rem",textAlign:"center",fontWeight:"600",color:"success.main",children:r("payment:views.success.title")}),(0,t.jsxs)("div",{children:[(0,t.jsx)(o.Typography,{component:"p",sx:{maxWidth:"65ch",textAlign:"center",mx:"auto"},children:r("payment:views.success.reason")}),(0,t.jsx)(o.Typography,{component:"p",sx:{maxWidth:"65ch",textAlign:"center",mx:"auto"},children:r("payment:views.success.description")})]}),(0,t.jsx)(y.W,{onClick:function(e){e.stopPropagation(),n()},variant:"contained",children:r("payment:views.success.back")})]})},S=function(){return S=Object.assign||function(e){for(var n,r=1,t=arguments.length;r<t;r++)for(var i in n=arguments[r])Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i]);return e},S.apply(this,arguments)},C=function(e,n,r){var i=r.selected;return(0,t.jsx)(o.Box,S({component:"li"},e,{sx:{textAlign:"left",display:"flex",flexDirection:"column",alignItems:"flex-start",width:"100%",p:1,backgroundColor:i?"background.tags":""},children:(0,t.jsxs)(o.Box,{width:"100%",children:[(0,t.jsx)(o.Box,{component:"div",sx:{font:"medium"},children:n.label}),(0,t.jsx)(o.Box,{component:"div",color:"text.secondary",sx:{fontSize:"12px"},children:n.owner})]})}))},T=C,O=C,E=r(9678),D=r(4262),F=r(6084),I=function(){return I=Object.assign||function(e){for(var n,r=1,t=arguments.length;r<t;r++)for(var i in n=arguments[r])Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i]);return e},I.apply(this,arguments)},A=function(e){var n=e.getError,r=e.getTranslationKey,i=e.isDisabled,s=(0,a.useFormContext)(),u=s.control,d=s.watch,p=(0,c.useTranslation)(["payment","validation"]).t,f=d("currency"),h=(0,F.k)(f),v=(0,l.useMemo)(function(){return function(e){var n;if(!["Backspace","ArrowLeft","ArrowRight","Delete","Tab"].includes(e.key)){var r=e.target,t=r.value,i=e.key,o=/^\d$/.test(i),l="."===i||","===i,a=t.includes(".")?".":t.includes(",")?",":null;if(o){if(a){var c=t.indexOf(a);if((null!==(n=r.selectionStart)&&void 0!==n?n:0)>c&&(t.split(a)[1]||"").length>=2)return void e.preventDefault()}}else l&&!a||e.preventDefault()}}},[]);return(0,t.jsx)(a.Controller,{name:"amount",control:u,render:function(e){var l=e.field,a=n(l.name);return(0,t.jsxs)(o.FormControl,{fullWidth:!0,error:!!a,disabled:h||i,children:[(0,t.jsx)(g.iy,{children:p(r("labels.amount"))}),(0,t.jsx)(g.ks,I({},l,{onKeyDown:v,error:!!a,helperText:p(a),value:h?F.w.toFixed(2):l.value,placeholder:p(r("placeholders.amount")),disabled:h||i})),h&&(0,t.jsx)(o.FormHelperText,{children:p(r("helperText.testPayment"))})]})}})},G=r(1366),L=function(e){return"validation:common.".concat(e)},W=G.pipe(G.object({id:G.union([G.number(),G.string()]),label:G.string()}),G.check(function(e){return null!==e},L("predefined"))),P=G.union([G.pipe(G.string(L("invalidString")),G.trim(),G.nonEmpty(L("required")),G.email(L("invalidEmail"))),G.object({id:G.string(L("invalidString")),label:G.string(L("invalidString")),owner:G.string()})],L("required")),q=G.union([G.pipe(G.string(L("invalidString")),G.trim(),G.nonEmpty(L("required"))),G.object({id:G.string(L("invalidString")),label:G.string(L("invalidString")),owner:G.string()})],L("required")),B=G.object({description:G.pipe(G.string(L("invalidString")),G.trim(),G.nonEmpty(L("required"))),amount:G.pipe(G.string(L("invalidString")),G.trim(),G.nonEmpty(L("required")),G.check(function(e){return!isNaN(Number(e))},function(){return L("invalidNumber")})),currency:G.enum(D.l),email:P,phone:q,paymentAccount:W,receiptDelivery:G.enum(D.I)}),M=function(){return M=Object.assign||function(e){for(var n,r=1,t=arguments.length;r<t;r++)for(var i in n=arguments[r])Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i]);return e},M.apply(this,arguments)},N=function(e){var n=e.initial,r=e.onSubmit,s=e.disabled,u=e.loading,d=void 0!==u&&u,p=(0,a.useForm)({defaultValues:n,resolver:(0,i.c)(B)}),f=x(),h=f.accounts,v=f.currencies,m=f.recieptDeliveryTransports,b=f.emails,j=f.phones,w=(0,c.useTranslation)(["payment","validation"]).t;(0,l.useEffect)(function(){h.length&&p.setValue("paymentAccount",h[0])},[h]);var k=p.formState.isSubmitting||s;return(0,t.jsx)(a.FormProvider,M({},p,{children:(0,t.jsxs)(o.Box,{component:"form",sx:{pt:4,px:1},onSubmit:p.handleSubmit(function(e){r(e)}),children:[(0,t.jsxs)(o.Grid,{container:!0,spacing:4,children:[(0,t.jsx)(o.Grid,{item:!0,xs:12,children:(0,t.jsx)(a.Controller,{name:"description",control:p.control,render:function(e){var n=e.field,r=S(n.name);return(0,t.jsxs)(o.FormControl,{fullWidth:!0,error:!!r,disabled:k,children:[(0,t.jsx)(g.iy,{children:w(C("labels.description"))}),(0,t.jsx)(g.ks,M({},n,{error:!!r,helperText:w(r),placeholder:w(C("placeholders.description")),disabled:k}))]})}})}),(0,t.jsx)(o.Grid,{item:!0,xs:8,children:(0,t.jsx)(A,{isDisabled:k,getError:S,getTranslationKey:C})}),(0,t.jsx)(o.Grid,{item:!0,xs:4,children:(0,t.jsx)(a.Controller,{name:"currency",control:p.control,render:function(e){var n=e.field,r=S(n.name);return(0,t.jsxs)(o.FormControl,{fullWidth:!0,error:!!r,disabled:k,children:[(0,t.jsx)(g.iy,{children:w(C("labels.currency"))}),(0,t.jsx)(g.ks,M({},n,{select:!0,error:!!r,helperText:w(r),id:"currency",placeholder:w(C("placeholders.currency")),disabled:k,children:null==v?void 0:v.map(function(e){return(0,t.jsx)(o.MenuItem,{value:e,children:(n=e,(0,F.k)(n)?"".concat(n," (for test account)"):n)},e);var n})}))]})}})}),(0,t.jsx)(o.Grid,{item:!0,xs:6,children:(0,t.jsx)(a.Controller,{name:"email",control:p.control,render:function(e){var n=e.field,r=S(n.name);return(0,t.jsxs)(o.FormControl,{fullWidth:!0,error:!!r,disabled:k,children:[(0,t.jsx)(g.iy,{children:w(C("labels.email"))}),(0,t.jsx)(g.G3,M({},n,{freeSolo:!0,options:b,disabled:k,onInputChange:function(e,r){n.onChange(r)},onChange:function(e,r){n.onChange(r)},renderOption:T,renderInput:function(e){return(0,t.jsx)(g.ks,M({},e,{error:!!r,helperText:w(r),placeholder:w(C("placeholders.email")),disabled:k}))}}))]})}})}),(0,t.jsx)(o.Grid,{item:!0,xs:6,children:(0,t.jsx)(a.Controller,{name:"phone",control:p.control,render:function(e){var n=e.field,r=S(n.name);return(0,t.jsxs)(o.FormControl,{fullWidth:!0,error:!!r,disabled:k,children:[(0,t.jsx)(g.iy,{children:w(C("labels.phone"))}),(0,t.jsx)(g.G3,M({},n,{freeSolo:!0,options:j,disabled:k,onInputChange:function(e,r){n.onChange(r)},onChange:function(e,r){n.onChange(r)},renderOption:O,renderInput:function(e){return(0,t.jsx)(g.ks,M({},e,{error:!!r,helperText:w(r),placeholder:w(C("placeholders.phone")),disabled:k}))}}))]})}})}),(0,t.jsx)(o.Grid,{item:!0,xs:8,children:(0,t.jsx)(a.Controller,{name:"paymentAccount",control:p.control,render:function(e){var n=e.field,r=n.value,i=n.onChange,l=function(e,n){var r={};for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&n.indexOf(t)<0&&(r[t]=e[t]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(t=Object.getOwnPropertySymbols(e);i<t.length;i++)n.indexOf(t[i])<0&&Object.prototype.propertyIsEnumerable.call(e,t[i])&&(r[t[i]]=e[t[i]])}return r}(n,["value","onChange"]),a=S(l.name);return(0,t.jsxs)(o.FormControl,{fullWidth:!0,error:!!a,disabled:k,children:[(0,t.jsx)(g.iy,{children:w(C("labels.paymentAccount"))}),(0,t.jsx)(g.ks,M({},l,{select:!0,value:(null==r?void 0:r.id)||"",onChange:function(e){var n=e.target.value,r=null==h?void 0:h.find(function(e){return e.id===n});i(r||null)},error:!!a,helperText:w(a),id:"currency",placeholder:w(C("placeholders.paymentAccount")),disabled:k,children:null==h?void 0:h.map(function(e){return(0,t.jsx)(o.MenuItem,{value:e.id,children:e.label},e.id)})}))]})}})}),(0,t.jsx)(o.Grid,{item:!0,xs:4,children:(0,t.jsx)(a.Controller,{name:"receiptDelivery",control:p.control,render:function(e){var n=e.field,r=S(n.name);return(0,t.jsxs)(o.FormControl,{fullWidth:!0,error:!!r,disabled:k,children:[(0,t.jsx)(g.iy,{children:w(C("labels.receiptDelivery"))}),(0,t.jsx)(g.ks,M({},n,{select:!0,error:!!r,helperText:w(r),placeholder:w(C("placeholders.receiptDelivery")),disabled:k,children:null==m?void 0:m.map(function(e){return(0,t.jsx)(o.MenuItem,{value:e,children:w(C("predefined.receiptDelivery.".concat(e.toLowerCase())))},e)})}))]})}})})]}),(0,t.jsx)(o.Stack,{pt:3,flexDirection:"row",justifyContent:"center",children:(0,t.jsx)(y.y,{fullWidth:!0,loading:d,type:"submit",variant:"contained",disabled:k,children:w(C("submit"))})})]})}));function S(e){var n,r,t=null!==(r=null===(n=p.formState.errors[e])||void 0===n?void 0:n.message)&&void 0!==r?r:"";return t?w(t):""}function C(e){return"payment:paymentForm.".concat(e)}};const R=function(){var e=(0,l.useState)("idle"),n=e[0],r=e[1],i=(0,l.useRef)(null),a=p().deal,c=function(){var e=(0,h.Cs)(),n=e[0],r=e[1],t=r.data;return{generateLink:function(e){return r=void 0,t=void 0,o=function(){return function(e,n){var r,t,i,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},l=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return l.next=a(0),l.throw=a(1),l.return=a(2),"function"==typeof Symbol&&(l[Symbol.iterator]=function(){return this}),l;function a(a){return function(c){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;l&&(l=0,a[0]&&(o=0)),o;)try{if(r=1,t&&(i=2&a[0]?t.return:a[0]?t.throw||((i=t.return)&&i.call(t),0):t.next)&&!(i=i.call(t,a[1])).done)return i;switch(t=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,t=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=n.call(e,o)}catch(e){a=[6,e],t=0}finally{r=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}}(this,function(r){switch(r.label){case 0:return[4,n(e)];case 1:return[2,r.sent()]}})},new((i=void 0)||(i=Promise))(function(e,n){function l(e){try{c(o.next(e))}catch(e){n(e)}}function a(e){try{c(o.throw(e))}catch(e){n(e)}}function c(n){var r;n.done?e(n.value):(r=n.value,r instanceof i?r:new i(function(e){e(r)})).then(l,a)}c((o=o.apply(r,t||[])).next())});var r,t,i,o},isLoading:r.isLoading,error:r.error,isError:r.isError,isSuccess:r.isSuccess,data:t,reset:r.reset}}(),u=c.generateLink,d=c.isLoading,v=c.error,y=c.isSuccess,g=c.reset,S=x(),C=S.accounts,T=S.currencies,O=S.isLoading,F=(0,f.h)(),I=F.errorNotification,A=F.successNotification,G=(0,l.useMemo)(function(){return function(e,n){var r,t,i,o,l,a=((null==e?void 0:e.contacts)||[])[0],c=(null!==(r=null==a?void 0:a.email)&&void 0!==r?r:[])[0],s=(null===(t=null==a?void 0:a.email)||void 0===t?void 0:t.find(function(e){return!!e.main}))||c,u=E.Cu||E.zD?D.l.XTS:n.find(function(n){var r;return n===(null===(r=null==e?void 0:e.amount)||void 0===r?void 0:r.currency)})||D.l.UAH;return{amount:(null===(i=null==e?void 0:e.amount)||void 0===i?void 0:i.value)||"0.00",currency:u,description:"",email:null!==(o=null==s?void 0:s.value)&&void 0!==o?o:"",paymentAccount:null,phone:null!==(l=null==a?void 0:a.phone)&&void 0!==l?l:"",receiptDelivery:D.I.None}}(a,T)},[a,T]),L="idle"===n,W="success"===n,P=(0,l.useCallback)(function(){return r("idle")},[]),q=(0,l.useCallback)(function(e){return n=void 0,r=void 0,i=function(){var n;return function(e,n){var r,t,i,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},l=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return l.next=a(0),l.throw=a(1),l.return=a(2),"function"==typeof Symbol&&(l[Symbol.iterator]=function(){return this}),l;function a(a){return function(c){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;l&&(l=0,a[0]&&(o=0)),o;)try{if(r=1,t&&(i=2&a[0]?t.return:a[0]?t.throw||((i=t.return)&&i.call(t),0):t.next)&&!(i=i.call(t,a[1])).done)return i;switch(t=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,t=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=n.call(e,o)}catch(e){a=[6,e],t=0}finally{r=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}}(this,function(r){switch(r.label){case 0:return n=(0,m.j)(e,a.id),[4,u(n)];case 1:return r.sent(),[2]}})},new((t=void 0)||(t=Promise))(function(e,o){function l(e){try{c(i.next(e))}catch(e){o(e)}}function a(e){try{c(i.throw(e))}catch(e){o(e)}}function c(n){var r;n.done?e(n.value):(r=n.value,r instanceof t?r:new t(function(e){e(r)})).then(l,a)}c((i=i.apply(n,r||[])).next())});var n,r,t,i},[a]);return(0,l.useEffect)(function(){v&&(I((0,s.u)(v)),i.current=setTimeout(function(){g(),i.current=null},3e3))},[v]),(0,l.useEffect)(function(){y&&(A(),r("success"))},[y]),(0,l.useEffect)(function(){return function(){null!==i.current&&(clearTimeout(i.current),i.current=null)}},[]),a?O?(0,t.jsx)(w,{}):(null==C?void 0:C.length)||O?(0,t.jsxs)(l.Suspense,{fallback:(0,t.jsx)(w,{}),children:[L&&(0,t.jsxs)(o.Stack,{gap:2,children:[(0,t.jsx)(N,{onSubmit:q,initial:G,disabled:d,loading:d}),!!v&&(0,t.jsx)(o.FormHelperText,{error:!0,sx:{fontSize:"1rem"},children:(0,s.u)(v)})]}),W&&(0,t.jsx)(k,{onClick:P})]}):(0,t.jsx)(j,{}):(0,t.jsx)(b,{})}}}]);
//# sourceMappingURL=6762.30439408.chunk.js.map